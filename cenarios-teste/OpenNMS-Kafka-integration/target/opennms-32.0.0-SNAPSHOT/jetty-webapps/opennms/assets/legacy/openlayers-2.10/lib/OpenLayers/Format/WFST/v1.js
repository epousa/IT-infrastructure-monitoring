OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(e){this.stateName={},this.stateName[OpenLayers.State.INSERT]="wfs:Insert",this.stateName[OpenLayers.State.UPDATE]="wfs:Update",this.stateName[OpenLayers.State.DELETE]="wfs:Delete",OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},getSrsName:function(e,t){var r=t&&t.srsName;return r||(r=e&&e.layer?e.layer.projection.getCode():this.srsName),r},read:function(e,t){t=t||{},OpenLayers.Util.applyDefaults(t,{output:"features"}),"string"==typeof e&&(e=OpenLayers.Format.XML.prototype.read.apply(this,[e])),e&&9==e.nodeType&&(e=e.documentElement);var r={};return e&&this.readNode(e,r),r.features&&"features"===t.output&&(r=r.features),r},readers:{wfs:{FeatureCollection:function(e,t){t.features=[],this.readChildNodes(e,t)}}},write:function(e){var t=this.writeNode("wfs:Transaction",e),r=this.schemaLocationAttr();return r&&this.setAttributeNS(t,this.namespaces.xsi,"xsi:schemaLocation",r),OpenLayers.Format.XML.prototype.write.apply(this,[t])},writers:{wfs:{GetFeature:function(e){var t=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,outputFormat:e&&e.outputFormat,maxFeatures:e&&e.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(e)}});if("string"==typeof this.featureType)this.writeNode("Query",e,t);else for(var r=0,s=this.featureType.length;r<s;r++)e.featureType=this.featureType[r],this.writeNode("Query",e,t);return t},Transaction:function(e){var t=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});if(e)for(var r,s,a=0,i=e.length;a<i;++a)s=e[a],(r=this.stateName[s.state])&&this.writeNode(r,s,t);return t},Insert:function(e){var t=this.createElementNSPlus("wfs:Insert");return this.srsName=this.getSrsName(e),this.writeNode("feature:_typeName",e,t),t},Update:function(e){var t=this.createElementNSPlus("wfs:Update",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});for(var r in this.featureNS&&t.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),null!==this.geometryName&&this.writeNode("Property",{name:this.geometryName,value:e},t),e.attributes)void 0!==e.attributes[r]&&this.writeNode("Property",{name:r,value:e.attributes[r]},t);return this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[e.fid]}),t),t},Property:function(e){var t=this.createElementNSPlus("wfs:Property");return this.writeNode("Name",e.name,t),null!==e.value&&this.writeNode("Value",e.value,t),t},Name:function(e){return this.createElementNSPlus("wfs:Name",{value:e})},Value:function(e){var t;if(e instanceof OpenLayers.Feature.Vector){t=this.createElementNSPlus("wfs:Value"),this.srsName=this.getSrsName(e);var r=this.writeNode("feature:_geometry",e.geometry).firstChild;t.appendChild(r)}else t=this.createElementNSPlus("wfs:Value",{value:e});return t},Delete:function(e){var t=this.createElementNSPlus("wfs:Delete",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});return this.featureNS&&t.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[e.fid]}),t),t}}},schemaLocationAttr:function(e){e=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},e);var t=OpenLayers.Util.extend({},this.schemaLocations);e.schema&&(t[e.featurePrefix]=e.schema);var r,s=[];for(var a in t)(r=this.namespaces[a])&&s.push(r+" "+t[a]);return s.join(" ")||void 0},setFilterProperty:function(e){if(e.filters)for(var t=0,r=e.filters.length;t<r;++t)this.setFilterProperty(e.filters[t]);else e instanceof OpenLayers.Filter.Spatial&&(e.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"});