OpenLayers.Tile.Image.IFrame=OpenLayers.Class(OpenLayers.Tile.Image,{initialize:function(e,i,t,r,a){OpenLayers.Tile.Image.prototype.initialize.apply(this,arguments),this.layerAlphaHack=!1},destroy:function(){null!=this.imgDiv&&OpenLayers.Event.stopObservingElement(this.imgDiv.firstChild),OpenLayers.Tile.Image.prototype.destroy.apply(this,arguments)},clear:function(){if(this.imgDiv){var e=this.imgDiv.firstChild;OpenLayers.Event.stopObservingElement(e),this.imgDiv.removeChild(e)}},clone:function(e){return null==e&&(e=new OpenLayers.Tile.Image.IFrame(this.layer,this.position,this.bounds,this.url,this.size)),e=OpenLayers.Tile.Image.prototype.clone.apply(this,[e])},renderTile:function(){if(OpenLayers.Tile.Image.prototype.renderTile.apply(this,arguments)){var e=this.createRequestForm();this.imgDiv.appendChild(e),e.submit(),this.imgDiv.removeChild(e)}},initImgDiv:function(){this.imgDiv=this.createImgDiv(),OpenLayers.Util.modifyDOMElement(this.imgDiv,this.id,null,this.layer.getImageSize(),"relative"),this.imgDiv.className="olTileImage",this.frame.appendChild(this.imgDiv),this.layer.div.appendChild(this.frame),null!=this.layer.opacity&&OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity),this.imgDiv.map=this.layer.map},createImgDiv:function(){var e=document.createElement("div");"msie"==OpenLayers.Util.getBrowserName()&&(e.style.backgroundColor="#FFFFFF",e.style.filter="chroma(color=#FFFFFF)"),OpenLayers.Util.modifyDOMElement(e,null,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");var i=document.createElement("div");return i.appendChild(e),i},createIFrame:function(){var e,i=this.id+"_iFrame";"msie"==OpenLayers.Util.getBrowserName()?((e=document.createElement('<iframe name="'+i+'">')).style.backgroundColor="#FFFFFF",e.style.filter="chroma(color=#FFFFFF)"):((e=document.createElement("iframe")).style.backgroundColor="transparent",e.name=i),e.id=i,e.scrolling="no",e.marginWidth="0px",e.marginHeight="0px",e.frameBorder="0",OpenLayers.Util.modifyDOMElement(e,i,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");return OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind((function(){this.show(),this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("loadend"))}),this)),e},createRequestForm:function(){var e=document.createElement("form");e.method="POST";var i=this.layer.params._OLSALT;i=(i?i+"_":"")+this.bounds.toBBOX(),e.action=OpenLayers.Util.urlAppend(this.layer.url,i),this.imgDiv.insertBefore(this.createIFrame(),this.imgDiv.firstChild),e.target=this.id+"_iFrame";var t=this.layer.getImageSize(),r=OpenLayers.Util.extend({BBOX:this.encodeBBOX?this.bounds.toBBOX():this.bounds.toArray(),WIDTH:t.w,HEIGHT:t.h},this.layer.params);for(var a in r){var n=document.createElement("input");n.type="hidden",n.name=a,n.value=r[a],e.appendChild(n)}return e},CLASS_NAME:"OpenLayers.Tile.Image.IFrame"});