OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(e,a,i,t){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments),this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||DEFAULT_FORMAT]},getURL:function(e){e=this.adjustBounds(e);var a=this.map.getResolution(),i=Math.round(1e4*this.map.getScale())/1e4,t=Math.round(e.left/a),s=-Math.round(e.top/a),p=Math.floor(t/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,r=Math.floor(s/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,h=this.url;return h instanceof Array&&(h=this.selectUrl(paramsString,h)),[h,"/",this.params.map,"/",i,"/",this.params.g.replace(/\s/g,"_"),"/def/t",r,"/l",p,"/t",s,"l",t,".",this.extension].join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});