OpenLayers.Rico=new Object,OpenLayers.Rico.Corner={round:function(t,o){t=OpenLayers.Util.getElement(t),this._setOptions(o);var r=this.options.color;"fromElement"==this.options.color&&(r=this._background(t));var e=this.options.bgColor;"fromParent"==this.options.bgColor&&(e=this._background(t.offsetParent)),this._roundCornersImpl(t,r,e)},changeColor:function(t,o){t.style.backgroundColor=o;for(var r=t.parentNode.getElementsByTagName("span"),e=0;e<r.length;e++)r[e].style.backgroundColor=o},changeOpacity:function(t,o){var r=o,e="alpha(opacity="+100*o+")";t.style.opacity=r,t.style.filter=e;for(var i=t.parentNode.getElementsByTagName("span"),n=0;n<i.length;n++)i[n].style.opacity=r,i[n].style.filter=e},reRound:function(t,o){var r=t.parentNode.childNodes[0],e=t.parentNode.childNodes[2];t.parentNode.removeChild(r),t.parentNode.removeChild(e),this.round(t.parentNode,o)},_roundCornersImpl:function(t,o,r){this.options.border&&this._renderBorder(t,r),this._isTopRounded()&&this._roundTopCorners(t,o,r),this._isBottomRounded()&&this._roundBottomCorners(t,o,r)},_renderBorder:function(t,o){var r="1px solid "+this._borderColor(o),e="style='"+("border-left: "+r)+";"+("border-right: "+r)+"'";t.innerHTML="<div "+e+">"+t.innerHTML+"</div>"},_roundTopCorners:function(t,o,r){for(var e=this._createCorner(r),i=0;i<this.options.numSlices;i++)e.appendChild(this._createCornerSlice(o,r,i,"top"));t.style.paddingTop=0,t.insertBefore(e,t.firstChild)},_roundBottomCorners:function(t,o,r){for(var e=this._createCorner(r),i=this.options.numSlices-1;i>=0;i--)e.appendChild(this._createCornerSlice(o,r,i,"bottom"));t.style.paddingBottom=0,t.appendChild(e)},_createCorner:function(t){var o=document.createElement("div");return o.style.backgroundColor=this._isTransparent()?"transparent":t,o},_createCornerSlice:function(t,o,r,e){var i=document.createElement("span"),n=i.style;n.backgroundColor=t,n.display="block",n.height="1px",n.overflow="hidden",n.fontSize="1px";var s=this._borderColor(t,o);return this.options.border&&0==r?(n.borderTopStyle="solid",n.borderTopWidth="1px",n.borderLeftWidth="0px",n.borderRightWidth="0px",n.borderBottomWidth="0px",n.height="0px",n.borderColor=s):s&&(n.borderColor=s,n.borderStyle="solid",n.borderWidth="0px 1px"),this.options.compact||r!=this.options.numSlices-1||(n.height="2px"),this._setMargin(i,r,e),this._setBorder(i,r,e),i},_setOptions:function(t){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},OpenLayers.Util.extend(this.options,t||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")||this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0?"":this.options.corners.indexOf("tl")>=0?"left":this.options.corners.indexOf("tr")>=0?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")||this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0?"":this.options.corners.indexOf("bl")>=0?"left":this.options.corners.indexOf("br")>=0?"right":""},_borderColor:function(t,o){return"transparent"==t?o:this.options.border?this.options.border:this.options.blend?this._blend(o,t):""},_setMargin:function(t,o,r){var e=this._marginSize(o),i="top"==r?this._whichSideTop():this._whichSideBottom();"left"==i?(t.style.marginLeft=e+"px",t.style.marginRight="0px"):"right"==i?(t.style.marginRight=e+"px",t.style.marginLeft="0px"):(t.style.marginLeft=e+"px",t.style.marginRight=e+"px")},_setBorder:function(t,o,r){var e=this._borderSize(o),i="top"==r?this._whichSideTop():this._whichSideBottom();"left"==i?(t.style.borderLeftWidth=e+"px",t.style.borderRightWidth="0px"):"right"==i?(t.style.borderRightWidth=e+"px",t.style.borderLeftWidth="0px"):(t.style.borderLeftWidth=e+"px",t.style.borderRightWidth=e+"px"),0!=this.options.border&&(t.style.borderLeftWidth=e+"px",t.style.borderRightWidth=e+"px")},_marginSize:function(t){if(this._isTransparent())return 0;return this.options.compact&&this.options.blend?[1,0][t]:this.options.compact?[2,1][t]:this.options.blend?[3,2,1,0][t]:[5,3,2,1][t]},_borderSize:function(t){return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?[1,0][t]:this.options.blend?[2,1,1,1][t]:this.options.border?[0,2,0,0][t]:this._isTransparent()?[5,3,2,1][t]:0},_hasString:function(t){for(var o=1;o<arguments.length;o++)if(t.indexOf(arguments[o])>=0)return!0;return!1},_blend:function(t,o){var r=OpenLayers.Rico.Color.createFromHex(t);return r.blend(OpenLayers.Rico.Color.createFromHex(o)),r},_background:function(t){try{return OpenLayers.Rico.Color.createColorFromBackground(t).asHex()}catch(t){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(t){return 1==t.childNodes.length&&3==t.childNodes[0].nodeType}};