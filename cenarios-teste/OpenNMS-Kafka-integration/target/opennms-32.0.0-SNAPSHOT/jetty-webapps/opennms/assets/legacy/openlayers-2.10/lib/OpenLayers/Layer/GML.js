OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:!1,format:null,formatOptions:null,initialize:function(e,t,s){var i=[];i.push(e,s),OpenLayers.Layer.Vector.prototype.initialize.apply(this,i),this.url=t},setVisibility:function(e,t){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},moveTo:function(e,t,s){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},loadGML:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this}),this.loaded=!0)},setUrl:function(e){this.url=e,this.destroyFeatures(),this.loaded=!1,this.loadGML()},requestSuccess:function(e){var t=e.responseXML;t&&t.documentElement||(t=e.responseText);var s={};OpenLayers.Util.extend(s,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(s.externalProjection=this.projection,s.internalProjection=this.map.getProjectionObject());var i=this.format?new this.format(s):new OpenLayers.Format.GML(s);this.addFeatures(i.read(t)),this.events.triggerEvent("loadend")},requestFailure:function(e){OpenLayers.Console.userError(OpenLayers.i18n("errorLoadingGML",{url:this.url})),this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"});