OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(e){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[e])},readers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(e,t){this.readChildNodes(e,t)},Curve:function(e,t){var r={points:[]};this.readChildNodes(e,r),t.components||(t.components=[]),t.components.push(new OpenLayers.Geometry.LineString(r.points))},segments:function(e,t){this.readChildNodes(e,t)},LineStringSegment:function(e,t){var r={};this.readChildNodes(e,r),r.points&&Array.prototype.push.apply(t.points,r.points)},pos:function(e,t){var r,n=this.getChildValue(e).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace);r=this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2]),t.points=[r]},posList:function(e,t){for(var r,n,i,s=this.getChildValue(e).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),o=parseInt(e.getAttribute("dimension"))||2,a=s.length/o,l=new Array(a),u=0,p=s.length;u<p;u+=o)r=s[u],n=s[u+1],i=2==o?void 0:s[u+2],this.xy?l[u/o]=new OpenLayers.Geometry.Point(r,n,i):l[u/o]=new OpenLayers.Geometry.Point(n,r,i);t.points=l},Surface:function(e,t){this.readChildNodes(e,t)},patches:function(e,t){this.readChildNodes(e,t)},PolygonPatch:function(e,t){this.readers.gml.Polygon.apply(this,[e,t])},exterior:function(e,t){var r={};this.readChildNodes(e,r),t.outer=r.components[0]},interior:function(e,t){var r={};this.readChildNodes(e,r),t.inner.push(r.components[0])},MultiCurve:function(e,t){var r={components:[]};this.readChildNodes(e,r),r.components.length>0&&(t.components=[new OpenLayers.Geometry.MultiLineString(r.components)])},curveMember:function(e,t){this.readChildNodes(e,t)},MultiSurface:function(e,t){var r={components:[]};this.readChildNodes(e,r),r.components.length>0&&(t.components=[new OpenLayers.Geometry.MultiPolygon(r.components)])},surfaceMember:function(e,t){this.readChildNodes(e,t)},surfaceMembers:function(e,t){this.readChildNodes(e,t)},pointMembers:function(e,t){this.readChildNodes(e,t)},lineStringMembers:function(e,t){this.readChildNodes(e,t)},polygonMembers:function(e,t){this.readChildNodes(e,t)},geometryMembers:function(e,t){this.readChildNodes(e,t)},Envelope:function(e,t){var r={points:new Array(2)};this.readChildNodes(e,r),t.components||(t.components=[]);var n=r.points[0],i=r.points[1];t.components.push(new OpenLayers.Bounds(n.x,n.y,i.x,i.y))},lowerCorner:function(e,t){var r={};this.readers.gml.pos.apply(this,[e,r]),t.points[0]=r.points[0]},upperCorner:function(e,t){var r={};this.readers.gml.pos.apply(this,[e,r]),t.points[1]=r.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(e){var t;t=e instanceof Array?"featureMembers":"featureMember";var r=this.writeNode("gml:"+t,e);return this.setAttributeNS(r,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[r])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(e){for(var t=this.createElementNSPlus("gml:featureMembers"),r=0,n=e.length;r<n;++r)this.writeNode("feature:_typeName",e[r],t);return t},Point:function(e){var t=this.createElementNSPlus("gml:Point");return this.writeNode("pos",e,t),t},pos:function(e){var t=this.xy?e.x+" "+e.y:e.y+" "+e.x;return this.createElementNSPlus("gml:pos",{value:t})},LineString:function(e){var t=this.createElementNSPlus("gml:LineString");return this.writeNode("posList",e.components,t),t},Curve:function(e){var t=this.createElementNSPlus("gml:Curve");return this.writeNode("segments",e,t),t},segments:function(e){var t=this.createElementNSPlus("gml:segments");return this.writeNode("LineStringSegment",e,t),t},LineStringSegment:function(e){var t=this.createElementNSPlus("gml:LineStringSegment");return this.writeNode("posList",e.components,t),t},posList:function(e){for(var t,r=e.length,n=new Array(r),i=0;i<r;++i)t=e[i],this.xy?n[i]=t.x+" "+t.y:n[i]=t.y+" "+t.x;return this.createElementNSPlus("gml:posList",{value:n.join(" ")})},Surface:function(e){var t=this.createElementNSPlus("gml:Surface");return this.writeNode("patches",e,t),t},patches:function(e){var t=this.createElementNSPlus("gml:patches");return this.writeNode("PolygonPatch",e,t),t},PolygonPatch:function(e){var t=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",e.components[0],t);for(var r=1,n=e.components.length;r<n;++r)this.writeNode("interior",e.components[r],t);return t},Polygon:function(e){var t=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",e.components[0],t);for(var r=1,n=e.components.length;r<n;++r)this.writeNode("interior",e.components[r],t);return t},exterior:function(e){var t=this.createElementNSPlus("gml:exterior");return this.writeNode("LinearRing",e,t),t},interior:function(e){var t=this.createElementNSPlus("gml:interior");return this.writeNode("LinearRing",e,t),t},LinearRing:function(e){var t=this.createElementNSPlus("gml:LinearRing");return this.writeNode("posList",e.components,t),t},MultiCurve:function(e){for(var t=this.createElementNSPlus("gml:MultiCurve"),r=0,n=e.components.length;r<n;++r)this.writeNode("curveMember",e.components[r],t);return t},curveMember:function(e){var t=this.createElementNSPlus("gml:curveMember");return this.curve?this.writeNode("Curve",e,t):this.writeNode("LineString",e,t),t},MultiSurface:function(e){for(var t=this.createElementNSPlus("gml:MultiSurface"),r=0,n=e.components.length;r<n;++r)this.writeNode("surfaceMember",e.components[r],t);return t},surfaceMember:function(e){var t=this.createElementNSPlus("gml:surfaceMember");return this.surface?this.writeNode("Surface",e,t):this.writeNode("Polygon",e,t),t},Envelope:function(e){var t=this.createElementNSPlus("gml:Envelope");return this.writeNode("lowerCorner",e,t),this.writeNode("upperCorner",e,t),this.srsName&&t.setAttribute("srsName",this.srsName),t},lowerCorner:function(e){var t=this.xy?e.left+" "+e.bottom:e.bottom+" "+e.left;return this.createElementNSPlus("gml:lowerCorner",{value:t})},upperCorner:function(e){var t=this.xy?e.right+" "+e.top:e.top+" "+e.right;return this.createElementNSPlus("gml:upperCorner",{value:t})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.curve?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":!1===this.multiCurve?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":!0===this.surface?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":!1===this.multiSurface?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});