OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,freehand:!1,freehandToggle:"shiftKey",initialize:function(e,t,i){OpenLayers.Handler.Point.prototype.initialize.apply(this,arguments)},createFeature:function(e){var t=this.control.map.getLonLatFromPixel(e);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat)),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(){OpenLayers.Handler.Point.prototype.destroyFeature.apply(this),this.line=null},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(e){this.layer.removeFeatures([this.point]);var t=this.control.map.getLonLatFromPixel(e);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon,t.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature()},freehandMode:function(e){return this.freehandToggle&&e[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(e){var t=this.control.map.getLonLatFromPixel(e);this.point.geometry.x=t.lon,this.point.geometry.y=t.lat,this.callback("modify",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var e=this.line&&this.line.geometry;return e&&this.multi&&(e=new OpenLayers.Geometry.MultiLineString([e])),e},mousedown:function(e){return this.lastDown&&this.lastDown.equals(e.xy)||(null==this.lastDown?(this.persist&&this.destroyFeature(),this.createFeature(e.xy)):null!=this.lastUp&&this.lastUp.equals(e.xy)||this.addPoint(e.xy),this.mouseDown=!0,this.lastDown=e.xy,this.drawing=!0),!1},mousemove:function(e){return this.drawing&&(this.mouseDown&&this.freehandMode(e)?this.addPoint(e.xy):this.modifyFeature(e.xy)),!0},mouseup:function(e){return this.mouseDown=!1,!this.drawing||(this.freehandMode(e)?(this.removePoint(),this.finalize()):(null==this.lastUp&&this.addPoint(e.xy),this.lastUp=e.xy),!1)},dblclick:function(e){if(!this.freehandMode(e)){var t=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[t]),this.removePoint(),this.finalize()}return!1},CLASS_NAME:"OpenLayers.Handler.Path"});