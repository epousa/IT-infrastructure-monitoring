{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///./src/main/assets/modules/lib/loader/index.ts"],"names":["OnmsLoader","prefix","extension","_classCallCheck","_defineProperty","_set","default","mappings","_createClass","key","value","load","_len","arguments","length","modules","Array","_key","console","log","fragment","document","createDocumentFragment","_i","_modules","module","loaded","debug","el","createElement","src","async","appendChild","error","body","waitFor","name","check","onready","_this","retry","undefined","nextRetry","Math","round","_setTimeout2","exports"],"mappings":"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","file":"loader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn ","/* eslint no-console: 0 */\n\nexport default class OnmsLoader {\n  public prefix = '/opennms/assets/';\n  public extension = '.vaadin.js';\n  private loaded = new Set<string>();\n  private mappings: object;\n\n  public constructor(prefix?: string, extension?: string) {\n    if (prefix) {\n      this.prefix = prefix;\n    }\n    if (extension) {\n      this.extension = extension;\n    }\n\n    this.mappings = {\n      'backshift': this.prefix + 'backshift-js' + this.extension,\n      'bootstrap': this.prefix + 'bootstrap-js' + this.extension,\n      'd3': this.prefix + 'd3-js' + this.extension,\n      'flot': this.prefix + 'flot-js' + this.extension,\n      'global': this.prefix + 'global' + this.extension,\n      'holder': this.prefix + 'holder-js' + this.extension,\n      'ionicons-css': this.prefix + 'ionicons-css' + this.extension,\n      'jquery': this.prefix + 'jquery-js' + this.extension,\n      'jquery-ui': this.prefix + 'jquery-ui-js' + this.extension,\n      'leaflet': this.prefix + 'leaflet-js' + this.extension,\n      'manifest': this.prefix + 'manifest' + this.extension,\n      'onms-graph': this.prefix + 'onms-graph' + this.extension,\n//      'openlayers': this.prefix + 'legacy/openlayers-2.10/OpenLayers.js',\n      'vendor': this.prefix + 'vendor' + this.extension,\n    };\n  }\n\n  public load(...modules: string[]) {\n    console.log('OnmsLoader: loading ' + modules.length + ' modules.');\n\n    const fragment = document.createDocumentFragment();\n    for (const module of modules) {\n      if (this.loaded[module]) {\n        console.log('OnmsLoader: skipping ' + module + ' (already loaded)');\n      } else {\n        if (this.mappings[module]) {\n          console.debug('OnmsLoader: loading ' + module);\n          const el = document.createElement('script');\n          el.src = this.mappings[module];\n          el.async = false;\n          fragment.appendChild(el);\n          this.loaded[module] = true;\n        } else {\n          console.error('OnmsLoader: no mapping for module \"' + module + '\"!');\n        }\n      }\n    }\n    document.body.appendChild(fragment);\n    console.log('OnmsLoader: finished loading modules');\n  }\n\n  public waitFor(name: string, check: () => boolean, onready: () => void, retry = 50) {\n    if (check()) {\n      console.log('OnmsLoader: ' + name + ' is ready.');\n      onready();\n    } else if (retry < 10000) {\n      const nextRetry = Math.round(retry * 1.5);\n      console.log('OnmsLoader: ' + name + ' is not ready. Trying again in ' + nextRetry + 'ms.');\n      setTimeout(() => {\n        this.waitFor(name, check, onready, nextRetry);\n      }, nextRetry);\n    } else {\n      console.log('OnmsLoader: giving up on ' + name);\n    }\n  }\n}\n"],"sourceRoot":""}