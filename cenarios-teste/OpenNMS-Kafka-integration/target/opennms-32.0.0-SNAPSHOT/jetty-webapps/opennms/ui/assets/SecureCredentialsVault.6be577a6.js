import{d as x,q as g,r as w,v as l,o as n,c as V,D as b,B as r,J as m,u as e,aU as z,j as f,M as I,af as J,t as B,L as F,ae as T,_ as S,k as c,b as H,R as C,z as N,aV as Z,y as M,f as E,ab as G}from"./index.5d30604a.js";const Q=x({__name:"SCVList",setup(u){const t=g(),s=w(),a=l(()=>t.state.scvModule.aliases),d=l(()=>t.state.scvModule.isEditing),p=o=>{s.value=o,t.dispatch("scvModule/getCredentialsByAlias",o)};return(o,y)=>(n(),V(e(T),{class:"scv-list"},{default:b(()=>[r(e(z),{class:"title"},{default:b(()=>[m(" Aliases ")]),_:1}),(n(!0),f(F,null,I(e(a),v=>(n(),V(e(J),{selected:s.value===v&&e(d),key:v,onClick:h=>p(v)},{default:b(()=>[m(B(v),1)]),_:2},1032,["selected","onClick"]))),128))]),_:1}))}});const W=S(Q,[["__scopeId","data-v-3f4730f7"]]);var X=(u,t)=>{const s=u.__vccOpts||u;for(const[a,d]of t)s[a]=d;return s};const Y={},ee={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},te=c("path",{d:"M18,13H13v5a1,1,0,0,1-1,1h0a1,1,0,0,1-1-1V13H6a1,1,0,0,1-1-1H5a1,1,0,0,1,1-1h5V6a1,1,0,0,1,1-1h0a1,1,0,0,1,1,1v5h5a1,1,0,0,1,1,1h0A1,1,0,0,1,18,13Z"},null,-1),ae=[te];function se(u,t){return n(),f("svg",ee,ae)}var re=X(Y,[["render",se]]);const le={class:"attribute-container",id:"scv-attribute"},oe=x({__name:"SCVAttribute",props:{attributeKey:{type:String,required:!0},attributeValue:{type:String,required:!0},attributeIndex:{type:Number,required:!0}},emits:["set-key-error"],setup(u,{emit:t}){const s=u,a=g(),d=w(),p=w(),o=l(()=>a.state.scvModule.credentials),y=_=>{const A=Object.entries(o.value.attributes);for(const[$,[K]]of A.entries())if(_===K&&$!==s.attributeIndex)return p.value="Duplicate keys not allowed.",t("set-key-error",!0),!0;return p.value=null,t("set-key-error",!1),!1},v=_=>{y(_)||a.dispatch("scvModule/updateAttribute",{key:s.attributeKey,keyVal:{key:_,value:s.attributeValue}})},h=_=>a.dispatch("scvModule/updateAttribute",{key:s.attributeKey,keyVal:{key:s.attributeKey,value:_}}),k=()=>a.dispatch("scvModule/removeAttribute",s.attributeKey);return H(()=>d.value.focus()),(_,A)=>(n(),f("div",le,[r(e(C),{"data-test":"attr-key",ref_key:"keyRef",ref:d,label:"key","onUpdate:modelValue":v,modelValue:u.attributeKey,error:p.value,class:"input"},null,8,["modelValue","error"]),r(e(C),{"data-test":"attr-value",label:"value","onUpdate:modelValue":h,modelValue:u.attributeValue,class:"input"},null,8,["modelValue"]),r(e(M),{icon:"Remove attribute",onClick:k,"data-test":"rm-attr-btn"},{default:b(()=>[r(e(N),{icon:e(Z)},null,8,["icon"])]),_:1})]))}});const ne=S(oe,[["__scopeId","data-v-88b4a167"]]),ue={class:"form-container",id:"scv"},de={class:"title"},ie={autocomplete:"off",class:"row"},ce={class:"btns"},_e=x({__name:"SCVForm",setup(u){const t=g(),s=w(!1),a=l(()=>t.state.scvModule.credentials),d=l(()=>t.state.scvModule.dbCredentials),p=l(()=>t.state.scvModule.aliases),o=l(()=>t.state.scvModule.isEditing),y=l(()=>Boolean(!a.value.alias||k.value||h.value||s.value)),v=i=>{for(const L of i)if(L!=="*")return!1;return!0},h=l(()=>{if(d.value.username&&a.value.password&&a.value.username!==d.value.username&&v(a.value.password))return"Password cannot be masked with updated usernames."}),k=l(()=>{if(!o.value&&a.value.alias&&p.value.includes(a.value.alias.toLowerCase()))return"Alias already in use."}),_=i=>s.value=i,A=i=>t.dispatch("scvModule/setValue",{alias:i.toLowerCase()}),$=i=>t.dispatch("scvModule/setValue",{username:i}),K=i=>t.dispatch("scvModule/setValue",{password:i}),R=()=>t.dispatch("scvModule/addCredentials"),q=()=>t.dispatch("scvModule/updateCredentials"),D=()=>t.dispatch("scvModule/clearCredentials"),P=()=>t.dispatch("scvModule/addAttribute");return(i,L)=>(n(),f("div",ue,[c("p",de,B(e(o)?"Update":"Add")+" Credentials",1),r(e(C),{"data-test":"alias-input",disabled:e(o),label:"Alias","onUpdate:modelValue":A,modelValue:e(a).alias,error:e(k),class:"alias-input"},null,8,["disabled","modelValue","error"]),c("form",ie,[r(e(C),{"data-test":"username-input",autocomplete:"new-username",label:"Username","onUpdate:modelValue":$,modelValue:e(a).username,class:"input"},null,8,["modelValue"]),r(e(C),{"data-test":"password-input",autocomplete:"new-password",label:"Password","onUpdate:modelValue":K,modelValue:e(a).password,error:e(h),class:"input"},null,8,["modelValue","error"])]),c("div",{class:"add-btn",onClick:P,"data-test":"add-attr-btn"},[r(e(N),{icon:e(re),"aria-hidden":"true",focusable:"false"},null,8,["icon"]),m(" Add attribute ")]),(n(!0),f(F,null,I(e(a).attributes,(j,U,O)=>(n(),V(ne,{key:U,attributeKey:U,attributeValue:j,attributeIndex:O,onSetKeyError:_},null,8,["attributeKey","attributeValue","attributeIndex"]))),128)),c("div",ce,[e(o)?E("",!0):(n(),V(e(M),{key:0,"data-test":"add-creds-btn",disabled:e(y),primary:"",onClick:R},{default:b(()=>[m(" Add Credentials ")]),_:1},8,["disabled"])),e(o)?(n(),V(e(M),{key:1,"data-test":"update-creds-btn",disabled:e(y),primary:"",onClick:q},{default:b(()=>[m(" Update Credentials ")]),_:1},8,["disabled"])):E("",!0),r(e(M),{primary:"","data-test":"clear-btn",onClick:D},{default:b(()=>[m(" Clear Form ")]),_:1})])]))}});const pe=S(_e,[["__scopeId","data-v-70baeef1"]]),ve={class:"feather-row"},be={class:"feather-col-12"},me={class:"scv-container"},fe={class:"list"},ye={class:"form"},he=x({__name:"SecureCredentialsVault",setup(u){const t=g(),s=l(()=>t.state.menuModule.mainMenu?.homeUrl),a=l(()=>[{label:"Home",to:s.value,isAbsoluteLink:!0},{label:"Secure Credentials Vault",to:"#",position:"last"}]);return H(()=>t.dispatch("scvModule/getAliases")),(d,p)=>(n(),f(F,null,[c("div",ve,[c("div",be,[r(G,{items:e(a)},null,8,["items"])])]),c("div",me,[c("div",fe,[r(W)]),c("div",ye,[r(pe)])])],64))}});const Ce=S(he,[["__scopeId","data-v-e1ba7866"]]);export{Ce as default};
