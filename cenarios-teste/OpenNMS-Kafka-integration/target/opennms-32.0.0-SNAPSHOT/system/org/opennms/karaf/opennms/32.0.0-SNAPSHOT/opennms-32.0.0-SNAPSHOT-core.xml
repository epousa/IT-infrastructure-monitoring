<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<features name="opennms-core-32.0.0-SNAPSHOT"
          xmlns="http://karaf.apache.org/xmlns/features/v1.3.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://karaf.apache.org/xmlns/features/v1.3.0 http://karaf.apache.org/xmlns/features/v1.3.0"
>

    <!--
         This file is for features that should be shared across Horizon, Minion, and Sentinel.
         Note that _any_ bundle dependency that has classes exported in `custom.properties` must
         have `dependency="true"` set, so that it won't try to re-load those classes on the
         Karaf side.
    -->

    <feature name="cassandra-driver" version="3.11.2" description="Datastax Cassandra Driver">
        <feature version="25.1.0" prerequisite="true">guava</feature>
        <feature version="[2.14.2,3)">jackson-core</feature>
        <feature version="[4.1.87.Final,5)">netty4</feature>
        <bundle dependency="true">mvn:io.dropwizard.metrics/metrics-core/3.1.2</bundle>
        <bundle dependency="true">mvn:com.github.jnr/jnr-ffi/2.1.7</bundle>
        <bundle dependency="true">mvn:com.github.jnr/jnr-posix/3.0.44</bundle>
        <bundle dependency="true">mvn:com.datastax.cassandra/cassandra-driver-core/3.11.2</bundle>
    </feature>

    <feature name="commons-lang3" version="3.12.0" description="Apache :: commons-lang3">
        <bundle>mvn:org.apache.commons/commons-lang3/3.12.0</bundle>
    </feature>

    <feature name="guava" version="25.1.0" description="Google :: Guava">
        <feature prerequisite="true">wrap</feature>
        <bundle start-level="30" dependency="true">mvn:com.google.guava/guava/25.1-jre</bundle>
        <bundle start-level="30" dependency="true">wrap:mvn:org.codehaus.mojo/animal-sniffer-annotations/1.14</bundle>
        <bundle start-level="30" dependency="true">wrap:mvn:com.google.errorprone/error_prone_annotations/2.10.0</bundle>
        <bundle start-level="30" dependency="true">wrap:mvn:org.checkerframework/checker-qual/2.0.0</bundle>
        <bundle start-level="30" dependency="true">wrap:mvn:com.google.j2objc/j2objc-annotations/1.1</bundle>
    </feature>

    <feature name="guava17" version="17.0" description="Google :: Guava">
        <bundle>mvn:com.google.guava/guava/17.0</bundle>
    </feature>

    <feature name="guava21" version="21.0" description="Google :: Guava">
        <bundle>mvn:com.google.guava/guava/21.0</bundle>
    </feature>

    <feature name="jackson-core" version="2.14.2" description="Jackson 2 :: Base">
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-databind/2.14.2</bundle>
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-annotations/2.14.2</bundle>
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-core/2.14.2</bundle>
    </feature>

    <feature name="jackson-dataformat-xml" version="2.14.2" description="Jackson 2 :: XML Data Format">
        <feature version="[2.14.2,3)">jackson-core</feature>
        <feature>snakeyaml</feature>
        <bundle dependency="true">mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/2.14.2</bundle>
    </feature>

    <feature name="jackson-dataformat-yaml" version="2.14.2" description="Jackson 2 :: YAML Data Format">
        <feature version="[2.14.2,3)">jackson-core</feature>
        <feature>snakeyaml</feature>
        <bundle dependency="true">mvn:com.fasterxml.jackson.dataformat/jackson-dataformat-yaml/2.14.2</bundle>
    </feature>

    <feature name="jackson-datatype-jdk8" version="2.14.2" description="Jackson 2 :: JDK8 Data Type">
        <feature version="[2.14.2,3)">jackson-core</feature>
        <bundle dependency="true">mvn:com.fasterxml.jackson.datatype/jackson-datatype-jdk8/2.14.2</bundle>
    </feature>

    <feature name="jackson-datatype-json" version="2.14.2" description="Jackson 2 :: JSON Data Type">
        <feature version="[2.14.2,3)">jackson-core</feature>
        <feature>org.json</feature>
        <bundle dependency="true">mvn:com.fasterxml.jackson.datatype/jackson-datatype-json-org/2.14.2</bundle>
    </feature>

    <feature name="jackson-datatype-jsr310" version="2.14.2" description="Jackson 2 :: JSR 310 Data Type">
        <feature version="[2.14.2,3)">jackson-core</feature>
        <bundle dependency="true">mvn:com.fasterxml.jackson.datatype/jackson-datatype-jsr310/2.14.2</bundle>
    </feature>

    <feature name="netty4" version="4.1.87.Final" description="Netty">
        <bundle dependency="true">mvn:io.netty/netty-buffer/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-codec/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-codec-dns/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-common/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-handler/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-resolver/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-resolver-dns/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-transport/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-transport-native-epoll/4.1.87.Final</bundle>
        <bundle dependency="true">mvn:io.netty/netty-transport-native-unix-common/4.1.87.Final</bundle>
    </feature>

    <feature name="org.json" version="20230227" description="org.json">
        <bundle>wrap:mvn:org.json/json/20230227$Export-Package=org.json</bundle>
    </feature>

    <feature name="snakeyaml" version="1.33" description="SnakeYAML">
        <bundle dependency="true">mvn:org.yaml/snakeyaml/1.33</bundle>
    </feature>

    <feature name="zookeeper-dependencies" version="3.5.10" description="ZooKeeper Dependencies">
        <feature prerequisite="true">wrap</feature>
        <feature version="25.1.0" prerequisite="true">guava</feature>
        <feature version="[2.14.2,3)">jackson-core</feature>
        <bundle dependency="true">wrap:mvn:org.apache.zookeeper/zookeeper/3.5.10</bundle>
        <bundle dependency="true">mvn:org.apache.curator/curator-client/3.2.1</bundle>
        <bundle dependency="true">mvn:org.apache.curator/curator-framework/3.2.1</bundle>
        <bundle dependency="true">mvn:org.apache.curator/curator-recipes/3.2.1</bundle>
    </feature>

    <feature name="scv-api" version="32.0.0-SNAPSHOT" description="Secure Credentials Vault">
        <bundle>mvn:org.opennms.features.scv/org.opennms.features.scv.api/32.0.0-SNAPSHOT</bundle>
    </feature>

    <feature name="scv-shell" version="32.0.0-SNAPSHOT" description="Secure Credentials Vault Shell">
        <feature>scv-api</feature>
        <bundle>mvn:org.opennms.features.scv/org.opennms.features.scv.shell/32.0.0-SNAPSHOT</bundle>
    </feature>

    <feature name="scv-jceks-impl" version="32.0.0-SNAPSHOT" description="Secure Credentials Vault JCEKS Impl">
        <feature version="25.1.0" prerequisite="true">guava</feature>
        <feature>scv-api</feature>
        <bundle dependency="true">mvn:commons-codec/commons-codec/1.15</bundle>
        <bundle>mvn:org.opennms.features.scv/org.opennms.features.scv.jceks-impl/32.0.0-SNAPSHOT</bundle>
    </feature>

    <!-- override the default Karaf ssh with a version from a newer release -->
    <feature name="ssh" description="Provide a SSHd server on Karaf" version="4.3.9">
        <feature>shell</feature>
        <feature>jaas</feature>
        <bundle start-level="30">mvn:org.apache.sshd/sshd-osgi/2.9.2</bundle>
        <bundle start-level="30">mvn:org.apache.sshd/sshd-scp/2.9.2</bundle>
        <bundle start-level="30">mvn:org.apache.sshd/sshd-sftp/2.9.2</bundle>
        <bundle start-level="30">mvn:org.bouncycastle/bcprov-jdk15on/1.70</bundle>
        <bundle start-level="30">mvn:org.bouncycastle/bcpkix-jdk15on/1.70</bundle>
        <bundle start-level="30">mvn:org.apache.karaf.shell/org.apache.karaf.shell.ssh/4.3.6</bundle>
    </feature>

    <feature name="health-api" version="32.0.0-SNAPSHOT" description="Health API">
        <feature version="3.12.0">commons-lang3</feature>
        <bundle dependency="true">mvn:org.opennms.core.health/org.opennms.core.health.api/32.0.0-SNAPSHOT</bundle>
        <bundle dependency="true">mvn:io.vavr/vavr/0.10.0</bundle>
    </feature>
</features>
